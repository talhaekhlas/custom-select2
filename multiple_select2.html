<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>multiple select 2</title>
	<style>
		*{
			margin:0;
			padding: 0;
			box-sizing: border-box;
		}
		.container{
			width: 100%;
			height: 100vh;
			background: #F8F9F9;
			margin:auto;
			position: relative;
		}

		.select-container{
			width: 60%; height: 60vh; 
			/*background: #189;*/
			left: 20%; 
			padding: 50px;
			position: absolute;
			min-width: 300px;
		}
		
		#ul-design{
			display: none;
		}

		.list-item{
			list-style: none;
			text-align: center;
			background: black;
			color: white;
			margin-bottom: 2px;
			height: 25px;
			cursor: pointer;
		}

		.list-item:hover{
			background: #FF5733;

		}

		.select-area{
			width: 100%;
			min-height: 30px;
			border: 1px solid gray;
			background: white;
			padding: 5px;
		}

		.cross{
			margin-left:15px;
			background: black;
			padding: 2px;
			color: white;
			cursor: pointer;
		}

		.cross:hover{
			background: red;
		}


	</style>
</head>
<body>
	<div class="container">
		<div class="select-container">
			<h2 align="center" style="font-style: italic;">This is multiple select 2</h2>
			
			<div class="select-area" id="select-section">
				<div id="dynamic-element" style="display: inline"></div>
				<input type="text" id="input_field" >
			</div>
			<ul id="ul-design">
				
			</ul>
		</div>
	</div>
</body>

<script>
	


	var listObject = [{name:'one',id:1},
				{name:'two',id:2},
				{name:'three',id:3},
				{name:'four',id:4},
				{name:'five',id:5}
	           ];

	function objToList(listObject){
        listItem = ''
		listObject.map((item,index)=>{
			
			listItem += '<li class="list-item">' + item.name + '</li>'
		})

		return listItem
	}

	var ulSection = document.querySelector('#ul-design'); 

	ulSection.innerHTML = objToList(listObject);
 

	var selectArea = document.querySelector('#select-section')


	selectArea.addEventListener('focus',function(e){
		console.log('focus ')
		ulSection.style.display = 'block'
	})




	// selectArea.addEventListener('keyup',function(e){
	// 	var searchText = e.target.innerText;

	// 	var filteredArray = listObject.filter((item,index)=>{
	// 		if (item.name.match(searchText) || (!searchText)) return true;
	// 		return false;
	// 	})


	// 	ulSection.innerHTML = objToList(filteredArray);
	// })


	ulSection.addEventListener('click',function(e){
		var btn = document.createElement("BUTTON"); 

		btn.style.margin = '2px'
		btn.style.padding = '2px'
		btn.style.minWidth = '80px'

		btn.innerHTML = '<span>'+e.target.innerText + '</span> <span class="cross">X</span>'; 


		var dynamicElement = document.querySelector('#dynamic-element')

		dynamicElement.appendChild(btn)

		inputField.value = ''


		
		// selectArea.insertAdjacentElement('afterbegin', btn)
	})




	var inputField = document.querySelector('#input_field')

	

	inputField.addEventListener('focus',function(){
		//console.log('input field focus')
		ulSection.style.display = 'block'
	})


	var actualPosition = 0;
	inputField.addEventListener('keydown',function(e){

		var ulTotalChild = ulSection.childElementCount;

		if(e.which==40) actualPosition++;
		if(e.which==38) actualPosition--;
		if(actualPosition<0) actualPosition=0;

		if(actualPosition>ulTotalChild) actualPosition = ulTotalChild;

		
		ulSection.style.display = 'block'

		



		if(e.which==13 && actualPosition){

    		var selectedData = ulSection.children[actualPosition-1].innerText;

			var btn = document.createElement("BUTTON"); 

			btn.style.margin = '2px'
			btn.style.padding = '2px'
			btn.style.minWidth = '80px'

			btn.innerHTML = '<span>'+selectedData + '</span> <span class="cross">X</span>'; 


			var dynamicElement = document.querySelector('#dynamic-element')

			dynamicElement.appendChild(btn)

			inputField.value = ''
    	}


	})



	inputField.addEventListener('keyup',function(e){
		
		var searchText = e.target.value;

		var filteredArray = listObject.filter((item,index)=>{
			if (item.name.match(searchText) || (!searchText)) return true;
			return false;
		})

		ulSection.innerHTML = objToList(filteredArray);

		if(actualPosition){
			var selectedItem = ulSection.children[actualPosition-1]

		    selectedItem.style.background = '#FF5733'
		}


		var dynamicElement = document.querySelector('#dynamic-element')

		console.log(dynamicElement,dynamicElement.childElementCount)

		var selectedItemArray = []

		// for(var i = 1;i<=dynamicElement.childElementCount;i++){
		// 	selectedItemArray[i] = dynamicElement.children[i].children[i].innerText
		// }

		console.log(dynamicElement.children[1])







	})

	



    document.addEventListener('click',function(e){


		if(e.target.className != 'list-item' && e.target.id !="input_field"){
			ulSection.style.display = 'none'
		}


	})
</script>
</html>